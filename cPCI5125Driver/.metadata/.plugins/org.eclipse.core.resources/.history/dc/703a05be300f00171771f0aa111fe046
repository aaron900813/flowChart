#include <stdio.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <fcntl.h>
#include <signal.h>
#include <sys/ioctl.h>
#include <unistd.h>
#include <string.h>
#include "LibcPCI5125.h"

#define ErrorCheck(func) {status = func; if(status != HR_STATUS_SUCCESS){printf("Error:%08x\n",status);}}
int main(void)
{

    int fd;
    TY_IOCTL_DATA val, val1;
    val.data = 0x200;
    val.offset = 0x1000;
    sprintf(dev_name, "/dev/cPCI5125");
    fd = open(dev_name,O_RDWR);
    if (fd <0 )
    {
        perror("open error");
        return -1;
    }
    printf("%s....fd0 = %d.\n", dev_name, fd);

    printf("%s....writebar2 offset %x value %x.\n", dev_name, val.offset , val.data);
    ioctl(fd, WRITEBAR2, &val);
    val.data = 0;
    val.offset = 0x1000;
    ioctl(fd, ReadBAR2, &val);
    printf("%s....readbar2 offset %x value %x.\n", dev_name, val.offset , val.data);
    close(fd);


    return 0;
}
